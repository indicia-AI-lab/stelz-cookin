{% comment %}
  Product Flavors Section - "Ontdek Alle Smaken"
  Premium product grid with category tabs and animated cards

  FIXES:
  1) CTA "BESTEL" linkt nu door naar block.settings.product_link (met fallback: geen link => button disabled)
  2) Default filter laadt op het EERSTE tabje (eerste category uit settings.categories). Dus als je eerste item HARD SELTZER is, start hij daarop.
{% endcomment %}

{% style %}
/* ==========================================================================
   PRODUCT FLAVORS SECTION - FULL CSS
   All values are customizable from the Shopify theme editor
   ========================================================================== */

/* CSS Variables - Generated from Theme Settings */
.product-flavors {
  /* Layout */
  --pf-padding-top: {{ section.settings.padding_top }}px;
  --pf-padding-bottom: {{ section.settings.padding_bottom }}px;
  --pf-max-width: {{ section.settings.max_width }}px;
  --pf-grid-columns-desktop: {{ section.settings.grid_columns_desktop }};
  --pf-grid-columns-mobile: {{ section.settings.grid_columns_mobile }};
  --pf-grid-gap: {{ section.settings.grid_gap }}px;
  
  /* Colors */
  --pf-bg: {{ section.settings.background_color }};
  --pf-text: {{ section.settings.text_color }};
  --pf-muted: {{ section.settings.muted_color }};
  --pf-primary: {{ section.settings.primary_color }};
  
  /* Glass Card Effect */
  --pf-card-bg-opacity: {{ section.settings.card_bg_opacity | divided_by: 100.0 }};
  --pf-card-blur: {{ section.settings.card_blur_amount }}px;
  --pf-radius: {{ section.settings.card_border_radius }}px;
  --pf-card-border-opacity: {{ section.settings.card_border_opacity | divided_by: 100.0 }};
  --pf-card-shadow-intensity: {{ section.settings.card_shadow_intensity | divided_by: 100.0 }};
  --pf-footer-bg-opacity: {{ section.settings.footer_bg_opacity | divided_by: 100.0 }};
  --pf-footer-blur: {{ section.settings.footer_blur_amount }}px;
  
  /* Accent Line */
  --pf-accent-line-height: {{ section.settings.accent_line_height }}px;
  --pf-accent-line-hover-height: {{ section.settings.accent_line_hover_height }}px;
  --pf-accent-line-glow: {{ section.settings.accent_line_glow }}px;
  
  /* Glow Effects */
  --pf-glow-default-opacity: {{ section.settings.glow_default_opacity | divided_by: 100.0 }};
  --pf-glow-hover-opacity: {{ section.settings.glow_hover_opacity | divided_by: 100.0 }};
  --pf-glow-scale: {{ section.settings.glow_scale_on_hover | divided_by: 100.0 }};
  --pf-gradient-default-opacity: {{ section.settings.gradient_default_opacity | divided_by: 100.0 }};
  --pf-gradient-hover-opacity: {{ section.settings.gradient_hover_opacity | divided_by: 100.0 }};
  
  /* Hover Animations */
  --pf-card-lift: {{ section.settings.card_lift_amount }}px;
  --pf-image-scale: {{ section.settings.image_scale_amount | divided_by: 100.0 }};
  --pf-image-rotate: {{ section.settings.image_rotate_amount }}deg;
  --pf-animation-duration: {{ section.settings.animation_duration }}ms;
  --pf-animation-easing: {{ section.settings.animation_easing }};
  
  /* Typography */
  --pf-title-size: {{ section.settings.title_font_size }}px;
  --pf-desc-size: {{ section.settings.description_font_size }}px;
  --pf-price-size: {{ section.settings.price_font_size }}px;
  --pf-cta-size: {{ section.settings.cta_font_size }}px;
  --pf-cta-padding-x: {{ section.settings.cta_padding_x }}px;
  --pf-cta-padding-y: {{ section.settings.cta_padding_y }}px;
  
  /* Computed values */
  --pf-glass-bg: linear-gradient(to bottom, rgba(255, 255, 255, var(--pf-card-bg-opacity)), rgba(255, 255, 255, calc(var(--pf-card-bg-opacity) * 0.6)));
  --pf-glass-border: rgba(0, 0, 0, var(--pf-card-border-opacity));
  --pf-glass-footer-bg: rgba(255, 255, 255, var(--pf-footer-bg-opacity));
  --pf-glass-footer-border: rgba(0, 0, 0, calc(var(--pf-card-border-opacity) * 0.75));
  --pf-shadow: 0 4px 24px -4px rgba(0, 0, 0, calc(0.08 * var(--pf-card-shadow-intensity) / 0.3)), 0 8px 48px -8px rgba(0, 0, 0, calc(0.06 * var(--pf-card-shadow-intensity) / 0.3));
  --pf-shadow-hover: 0 8px 32px -4px rgba(0, 0, 0, calc(0.12 * var(--pf-card-shadow-intensity) / 0.3)), 0 16px 64px -8px rgba(0, 0, 0, calc(0.1 * var(--pf-card-shadow-intensity) / 0.3));
  
  /* Additional variables */
  --pf-tab-bg: rgba(255, 255, 255, 0.9);
  --pf-tab-bg-hover: #FFFFFF;
  --pf-tab-border-hover: rgba(197, 165, 114, 0.3);
  --pf-tab-active-bg: var(--pf-text);
  --pf-tab-active-text: #FFFFFF;
  --pf-cta-bg: var(--pf-text);
  --pf-cta-text: #FFFFFF;
  --pf-cta-hover-bg: #333333;
  --pf-image-gradient: rgba(255, 255, 255, 0.5);
  --pf-blur-accent: rgba(197, 165, 114, 0.1);
}

/* CSS Variables - Dark Mode Overrides */
html.dark-mode .product-flavors {
  --pf-tab-bg: rgba(30, 30, 30, 0.9);
  --pf-tab-bg-hover: #252525;
  --pf-tab-border-hover: rgba(212, 184, 150, 0.4);
  --pf-tab-active-bg: #D4B896;
  --pf-tab-active-text: #0A0A0A;
  --pf-cta-bg: #D4B896;
  --pf-cta-text: #0A0A0A;
  --pf-cta-hover-bg: #E5CDB0;
  --pf-image-gradient: rgba(21, 21, 21, 0.5);
  --pf-blur-accent: rgba(212, 184, 150, 0.15);
}

/* Base Section */
.product-flavors {
  position: relative;
  padding: var(--pf-padding-top) 0 var(--pf-padding-bottom);
  overflow: hidden;
  background-color: var(--pf-bg);
  contain: layout style paint;
}

/* Texture Overlay */
.product-flavors__texture {
  position: absolute;
  inset: 0;
  opacity: {% if section.settings.enable_texture_overlay %}0.08{% else %}0{% endif %};
  pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
  mix-blend-mode: overlay;
}

/* Parallax Blur Elements - GPU accelerated */
.product-flavors__blur {
  position: absolute;
  border-radius: 50%;
  filter: blur(100px);
  pointer-events: none;
  transition: transform 0.1s linear;
  transform: translateZ(0);
  will-change: transform;
}

.product-flavors__blur--left {
  top: 25%;
  left: -5rem;
  width: 16rem;
  height: 16rem;
  background: var(--pf-blur-accent);
}

.product-flavors__blur--right {
  bottom: 25%;
  right: -5rem;
  width: 20rem;
  height: 20rem;
  background: var(--pf-blur-accent);
  opacity: 0.8;
}

/* Container */
.product-flavors__container {
  position: relative;
  width: 100%;
  max-width: var(--pf-max-width);
  margin: 0 auto;
  padding: 0 1.5rem;
}

@media (min-width: 768px) {
  .product-flavors__container {
    padding: 0 2rem;
  }
}

/* Header */
.product-flavors__header {
  text-align: center;
  margin-bottom: 4rem;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.8s ease, transform 0.8s ease;
}

.product-flavors__header.is-visible {
  opacity: 1;
  transform: translateY(0);
}

.product-flavors__label {
  display: inline-block;
  font-family: var(--font-display, 'Bebas Neue', sans-serif);
  font-size: 0.875rem;
  letter-spacing: 0.3em;
  color: var(--pf-primary);
  margin-bottom: 1rem;
}

.product-flavors__title {
  font-family: var(--font-display, 'Bebas Neue', sans-serif);
  font-size: clamp(3rem, 8vw, 6rem);
  line-height: 0.95;
  color: var(--pf-text);
  margin: 0 0 1.5rem;
}

/* USP Tags */
.product-flavors__usps {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 1rem 2rem;
  color: var(--pf-muted);
  font-size: 0.9375rem;
}

.product-flavors__usp {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.product-flavors__usp-dot {
  width: 0.5rem;
  height: 0.5rem;
  border-radius: 50%;
  background: var(--pf-primary);
  animation: pulse 2s ease-in-out infinite;
}

.product-flavors__usp:nth-child(2) .product-flavors__usp-dot { animation-delay: 0.2s; }
.product-flavors__usp:nth-child(3) .product-flavors__usp-dot { animation-delay: 0.4s; }
.product-flavors__usp:nth-child(4) .product-flavors__usp-dot { animation-delay: 0.6s; }

@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(0.8); }
}

/* Category Tabs */
.product-flavors__tabs {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.75rem;
  margin-bottom: 4rem;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.8s ease 0.2s, transform 0.8s ease 0.2s;
}

.product-flavors__tabs.is-visible {
  opacity: 1;
  transform: translateY(0);
}

.product-flavors__tab {
  position: relative;
  font-family: var(--font-display, 'Bebas Neue', sans-serif);
  font-size: 1.125rem;
  padding: 1rem 2rem;
  border-radius: 9999px;
  border: 1px solid var(--pf-border);
  background: var(--pf-tab-bg);
  color: var(--pf-text);
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

@media (min-width: 768px) {
  .product-flavors__tab {
    font-size: 1.25rem;
  }
}

.product-flavors__tab:hover {
  background: var(--pf-tab-bg-hover);
  border-color: var(--pf-tab-border-hover);
  transform: translateY(-2px);
}

.product-flavors__tab.is-active {
  background: var(--pf-tab-active-bg);
  color: var(--pf-tab-active-text);
  border-color: var(--pf-tab-active-bg);
  box-shadow: var(--pf-shadow);
  font-weight: 500;
}

.product-flavors__tab-count {
  margin-left: 0.5rem;
  opacity: 0.6;
  font-size: 0.875em;
}

/* Product Grid */
.product-flavors__grid {
  display: grid;
  grid-template-columns: repeat(var(--pf-grid-columns-mobile), 1fr);
  gap: var(--pf-grid-gap);
}

@media (min-width: 768px) {
  .product-flavors__grid {
    grid-template-columns: repeat(var(--pf-grid-columns-desktop), 1fr);
  }
}

/* Product Card - Glass Morphism */
.product-card {
  position: relative;
  background: var(--pf-glass-bg);
  border-radius: var(--pf-radius);
  overflow: hidden;
  box-shadow: var(--pf-shadow);
  border: 1px solid var(--pf-glass-border);
  backdrop-filter: blur(var(--pf-card-blur));
  -webkit-backdrop-filter: blur(var(--pf-card-blur));
  opacity: 0;
  transform: translateY(20px) translateZ(0);
  transition: all var(--pf-animation-duration) var(--pf-animation-easing), box-shadow var(--pf-animation-duration) ease;
  will-change: transform, opacity;
}

.product-card.is-visible {
  opacity: 1;
  transform: translateY(0);
}

.product-card:hover {
  box-shadow: 
    var(--pf-shadow-hover),
    0 0 40px rgba(var(--card-accent-rgb, 197, 165, 114), 0.15);
  transform: translateY(calc(var(--pf-card-lift) * -1));
  border-color: rgba(255, 255, 255, 0.12);
}

/* Card hidden for category filtering */
.product-card[data-hidden="true"] {
  display: none;
}

/* Accent Line at Top of Card */
.product-card__accent-line {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: var(--pf-accent-line-height);
  background: var(--card-accent-color, var(--pf-primary));
  z-index: 10;
  transition: height var(--pf-animation-duration) ease, box-shadow var(--pf-animation-duration) ease;
}

.product-card:hover .product-card__accent-line {
  height: var(--pf-accent-line-hover-height);
  box-shadow: 
    0 0 var(--pf-accent-line-glow) var(--card-accent-color, var(--pf-primary)),
    0 0 calc(var(--pf-accent-line-glow) * 2) var(--card-accent-color, var(--pf-primary)),
    0 2px calc(var(--pf-accent-line-glow) * 1.3) var(--card-accent-color, var(--pf-primary));
}

/* Card Gradient Overlay - Always visible, intensifies on hover */
.product-card__gradient {
  position: absolute;
  inset: 0;
  opacity: var(--pf-gradient-default-opacity);
  transition: opacity var(--pf-animation-duration) ease;
  pointer-events: none;
}

.product-card:hover .product-card__gradient {
  opacity: var(--pf-gradient-hover-opacity);
}

/* Product Image */
.product-card__image-wrapper {
  position: relative;
  height: 11rem;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1.5rem;
}

@media (min-width: 768px) {
  .product-card__image-wrapper {
    height: 14rem;
  }
}

.product-card__image-wrapper::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(to bottom, transparent 60%, var(--pf-image-gradient));
  pointer-events: none;
}

.product-card__image {
  position: relative;
  z-index: 1;
  height: 100%;
  width: auto;
  max-width: 100%;
  object-fit: contain;
  filter: drop-shadow(0 15px 30px rgba(0, 0, 0, 0.2));
  transition: transform var(--pf-animation-duration) var(--pf-animation-easing), filter var(--pf-animation-duration) ease;
  transform: translateZ(0);
  will-change: transform, filter;
}

.product-card:hover .product-card__image {
  transform: scale(var(--pf-image-scale)) rotate(var(--pf-image-rotate));
  filter: drop-shadow(0 30px 50px var(--card-accent-color, rgba(197, 165, 114, 0.4)));
}

/* Radial Glow Effect - Always visible, intensifies on hover */
.product-card__glow-overlay {
  position: absolute;
  inset: 0;
  opacity: var(--pf-glow-default-opacity);
  background: radial-gradient(ellipse at 50% 30%, var(--card-accent-color, rgba(197, 165, 114, 0.5)), transparent 60%);
  pointer-events: none;
  transition: opacity var(--pf-animation-duration) ease, transform var(--pf-animation-duration) ease;
  z-index: 0;
}

.product-card:hover .product-card__glow-overlay {
  opacity: var(--pf-glow-hover-opacity);
  transform: scale(var(--pf-glow-scale));
}

/* Product Info - Frosted Footer */
.product-card__info {
  position: relative;
  padding: 0.75rem 1.25rem 1.25rem;
  text-align: center;
  background: var(--pf-glass-footer-bg);
  backdrop-filter: blur(var(--pf-footer-blur));
  -webkit-backdrop-filter: blur(var(--pf-footer-blur));
  border-top: 1px solid var(--pf-glass-footer-border);
}

.product-card__name {
  font-family: var(--font-display, 'Bebas Neue', sans-serif);
  font-size: var(--pf-title-size);
  color: var(--pf-text);
  margin: 0 0 0.25rem;
}

.product-card__description {
  color: var(--pf-muted);
  font-size: var(--pf-desc-size);
  line-height: 1.4;
  margin-bottom: 1rem;
  min-height: 2.5rem;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Price & CTA Row */
.product-card__footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.75rem;
}

.product-card__price {
  font-family: var(--font-display, 'Bebas Neue', sans-serif);
  font-size: var(--pf-price-size);
  color: var(--pf-text);
}

.product-card__cta {
  font-family: var(--font-display, 'Bebas Neue', sans-serif);
  font-size: var(--pf-cta-size);
  padding: var(--pf-cta-padding-y) var(--pf-cta-padding-x);
  border-radius: 9999px;
  background: var(--pf-cta-bg);
  color: var(--pf-cta-text);
  border: none;
  cursor: pointer;
  transition: all var(--pf-animation-duration) ease;
  white-space: nowrap;
  font-weight: 500;
}

.product-card__cta:hover {
  background: var(--pf-cta-hover-bg);
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.product-card__cta[aria-disabled="true"] {
  opacity: 0.55;
  cursor: not-allowed;
  transform: none;
}

/* Make CTA link behave like button */
.product-card__cta-link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
}

/* Hover Glow */
.product-card__glow {
  position: absolute;
  inset: 0;
  border-radius: var(--pf-radius);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s ease;
}

.product-card:hover .product-card__glow {
  opacity: 1;
}

/* Section Footer */
.product-flavors__footer {
  text-align: center;
  margin-top: 3rem;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.8s ease 0.7s, transform 0.8s ease 0.7s;
  content-visibility: auto;
  contain-intrinsic-size: auto 150px;
}

.product-flavors__footer.is-visible {
  opacity: 1;
  transform: translateY(0);
}

.product-flavors__footer-text {
  color: var(--pf-muted);
  font-size: 0.875rem;
  margin-bottom: 1rem;
}

.product-flavors__view-all {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  font-family: var(--font-display, 'Bebas Neue', sans-serif);
  font-size: 1.125rem;
  color: var(--pf-text);
  text-decoration: none;
  transition: color 0.3s ease;
}

.product-flavors__view-all:hover {
  color: var(--pf-primary);
}

.product-flavors__view-all svg {
  width: 1.25rem;
  height: 1.25rem;
  transition: transform 0.3s ease;
}

.product-flavors__view-all:hover svg {
  transform: translateX(4px);
}

/* ==========================================================================
   REDUCED MOTION
   ========================================================================== */
@media (prefers-reduced-motion: reduce) {
  .product-flavors__header,
  .product-flavors__tabs,
  .product-card,
  .product-flavors__footer {
    opacity: 1;
    transform: none;
    transition: none;
  }

  .product-flavors__usp-dot {
    animation: none;
  }

  .product-card__image {
    transition: none;
  }

  .product-card:hover .product-card__image {
    transform: none;
  }
}

/* CTA Button Styling */
.reviews-cta-button {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem 2rem;
  font-family: var(--font-display, 'Bebas Neue', sans-serif);
  font-size: 1.125rem;
  font-weight: 500;
  color: var(--pf-cta-text);
  background: var(--pf-cta-bg);
  border-radius: 9999px;
  border: none;
  cursor: pointer;
  position: relative;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  box-shadow: var(--pf-shadow);
  text-decoration: none;
  margin-top: 1.5rem;
}

/* Hover State */
.reviews-cta-button:hover {
  transform: scale(1.05);
  background: var(--pf-cta-hover-bg);
  box-shadow: var(--pf-shadow-hover);
}

/* Arrow Animation */
.reviews-cta-button .cta-arrow {
  transition: transform 0.3s ease;
}

.reviews-cta-button:hover .cta-arrow {
  transform: translateX(4px);
}

/* Optional: Shine Effect on Hover */
.reviews-cta-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s ease;
}

.reviews-cta-button:hover::before {
  left: 100%;
}
{% endstyle %}

{%- assign categories = section.settings.categories | split: ',' -%}
{%- assign first_category_id = '' -%}
{%- if categories.size > 0 -%}
  {%- assign first_parts = categories[0] | split: ':' -%}
  {%- assign first_category_id = first_parts[0] | strip -%}
{%- endif -%}

<section
  class="product-flavors"
  id="product-flavors-{{ section.id }}"
  data-section-id="{{ section.id }}"
  data-default-category="{{ first_category_id }}"
>
  <!-- Texture Overlay -->
  <div class="product-flavors__texture" aria-hidden="true"></div>

  <!-- Parallax Blur Elements -->
  <div class="product-flavors__blur product-flavors__blur--left" data-parallax="0.08" aria-hidden="true"></div>
  <div class="product-flavors__blur product-flavors__blur--right" data-parallax="0.12" aria-hidden="true"></div>

  <div class="product-flavors__container">
    <!-- Header -->
    <header class="product-flavors__header" data-animate>
      <span class="product-flavors__label">{{ section.settings.label }}</span>
      <h2 class="product-flavors__title">{{ section.settings.title }}</h2>

      <!-- USP Tags -->
      <div class="product-flavors__usps">
        {%- for block in section.blocks -%}
          {%- if block.type == 'usp' -%}
            <span class="product-flavors__usp" {{ block.shopify_attributes }}>
              <span class="product-flavors__usp-dot"></span>
              {{ block.settings.text }}
            </span>
          {%- endif -%}
        {%- endfor -%}
      </div>
    </header>

    <!-- Category Tabs -->
    <div class="product-flavors__tabs" data-animate>
      {%- for category in categories -%}
        {%- assign cat_parts = category | split: ':' -%}
        {%- assign cat_id = cat_parts[0] | strip -%}
        {%- assign cat_name = cat_parts[1] | strip -%}
        {%- assign cat_count = cat_parts[2] | strip -%}
        <button
          class="product-flavors__tab{% if forloop.first %} is-active{% endif %}"
          data-category="{{ cat_id }}"
          type="button"
        >
          {{ cat_name }}<span class="product-flavors__tab-count">({{ cat_count }})</span>
        </button>
      {%- endfor -%}
    </div>

    <!-- Product Grid -->
    <div class="product-flavors__grid">
      {%- for block in section.blocks -%}
        {%- if block.type == 'product' -%}
          <article
            class="product-card"
            style="--card-accent-color: {{ block.settings.accent_color }};"
            data-category="{{ block.settings.category }}"
            data-delay="{{ forloop.index | times: 100 | plus: 300 }}"
            data-animate
            {{ block.shopify_attributes }}
          >
            {%- if section.settings.show_accent_line -%}
              <!-- Accent Line -->
              <div class="product-card__accent-line" aria-hidden="true"></div>
            {%- endif -%}

            <!-- Glow Overlay (hover effect) -->
            <div class="product-card__glow-overlay" aria-hidden="true"></div>

            <!-- Gradient Overlay -->
            <div
              class="product-card__gradient"
              style="background: radial-gradient(circle at 50% 30%, {{ block.settings.accent_color }}, transparent 70%);"
              aria-hidden="true"
            ></div>

            <!-- Product Image -->
            <div class="product-card__image-wrapper">
              {%- if block.settings.image != blank -%}
                <img
                  src="{{ block.settings.image | image_url: width: 400 }}"
                  srcset="{{ block.settings.image | image_url: width: 200 }} 200w,
                          {{ block.settings.image | image_url: width: 400 }} 400w,
                          {{ block.settings.image | image_url: width: 600 }} 600w"
                  sizes="(max-width: 640px) 50vw, (max-width: 1024px) 33vw, 20vw"
                  alt="{{ block.settings.name }} - STËLZ"
                  class="product-card__image"
                  loading="lazy"
                  decoding="async"
                  width="400"
                  height="500"
                >
              {%- else -%}
                {{ 'product-1' | placeholder_svg_tag: 'product-card__image' }}
              {%- endif -%}
            </div>

            <!-- Product Info -->
            <div class="product-card__info">
              <h3 class="product-card__name">{{ block.settings.name }}</h3>
              <p class="product-card__description">{{ block.settings.description }}</p>

              <div class="product-card__footer">
                <span class="product-card__price">{{ block.settings.price }}</span>

                {%- if block.settings.product_link != blank -%}
                  <a
                    class="product-card__cta product-card__cta-link"
                    href="{{ block.settings.product_link }}"
                    aria-label="{{ section.settings.cta_text }} {{ block.settings.name }}"
                  >
                    {{ section.settings.cta_text }}
                  </a>
                {%- else -%}
                  <button class="product-card__cta" type="button" aria-disabled="true" tabindex="-1">
                    {{ section.settings.cta_text }}
                  </button>
                {%- endif -%}
              </div>
            </div>

            <!-- Hover Glow -->
            <div
              class="product-card__glow"
              style="box-shadow: inset 0 0 30px {{ block.settings.accent_color }};"
              aria-hidden="true"
            ></div>
          </article>
        {%- endif -%}
      {%- endfor -%}
    </div>

    <!-- Footer -->
    <footer class="product-flavors__footer" data-animate>
      <p class="product-flavors__footer-text">{{ section.settings.footer_text }}</p>
      {%- if section.settings.view_all_link != blank -%}
        <a href="{{ section.settings.view_all_link }}" class="product-flavors__view-all">
          {{ section.settings.view_all_text }}
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      {%- endif -%}

      {%- if section.settings.reviews_cta_url != blank -%}
        <a href="{{ section.settings.reviews_cta_url }}" class="reviews-cta-button">
          <span>{{ section.settings.reviews_cta_text | default: 'Ontdek alle smaken' }}</span>
          <svg class="cta-arrow" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </a>
      {%- endif -%}
    </footer>
  </div>
</section>

<script>
(function() {
  const section = document.getElementById('product-flavors-{{ section.id }}');
  if (!section) return;

  // Category Tab Switching
  const tabs = section.querySelectorAll('.product-flavors__tab');
  const cards = section.querySelectorAll('.product-card');

  function applyFilter(category) {
    cards.forEach((card, index) => {
      const cardCategory = card.dataset.category;
      if (category === 'all' || cardCategory === category) {
        card.dataset.hidden = 'false';
        card.style.transitionDelay = `${index * 80}ms`;
      } else {
        card.dataset.hidden = 'true';
      }
    });
  }

  // Default: first tab's category (so it loads as Hard Seltzer if that's first)
  const defaultCategory = section.dataset.defaultCategory || (tabs[0] ? tabs[0].dataset.category : 'all');
  applyFilter(defaultCategory);

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const category = tab.dataset.category;

      // Update active tab
      tabs.forEach(t => t.classList.remove('is-active'));
      tab.classList.add('is-active');

      // Filter products
      applyFilter(category);
    });
  });

  // Intersection Observer for animations
  const animateElements = section.querySelectorAll('[data-animate]');

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const delay = entry.target.dataset.delay || 0;
        setTimeout(() => {
          entry.target.classList.add('is-visible');
        }, delay);
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.1 });

  animateElements.forEach(el => observer.observe(el));

  // Parallax effect for blur elements
  const parallaxElements = section.querySelectorAll('[data-parallax]');

  function updateParallax() {
    const scrollY = window.scrollY;
    const sectionTop = section.offsetTop;
    const sectionHeight = section.offsetHeight;
    const viewportHeight = window.innerHeight;

    if (scrollY + viewportHeight > sectionTop && scrollY < sectionTop + sectionHeight) {
      const progress = (scrollY + viewportHeight - sectionTop) / (viewportHeight + sectionHeight);

      parallaxElements.forEach(el => {
        const speed = parseFloat(el.dataset.parallax) || 0.1;
        const direction = el.classList.contains('product-flavors__blur--right') ? -1 : 1;
        const offset = (progress - 0.5) * 200 * speed * direction;
        el.style.transform = `translateY(${offset}px)`;
      });
    }
  }

  let ticking = false;
  window.addEventListener('scroll', () => {
    if (!ticking) {
      requestAnimationFrame(() => {
        updateParallax();
        ticking = false;
      });
      ticking = true;
    }
  }, { passive: true });

  updateParallax();
})();
</script>

{% schema %}
{
  "name": "Product Flavors",
  "tag": "section",
  "class": "section-product-flavors",
  "settings": [
    {
      "type": "text",
      "id": "label",
      "label": "Section Label",
      "default": "ONZE COLLECTIE"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "ONTDEK ALLE SMAKEN"
    },
    {
      "type": "textarea",
      "id": "categories",
      "label": "Categories (format: id:name:count, comma separated)",
      "default": "seltzer:HARD SELTZER:5, icedtea:HARD ICED TEA:4, classics:MIXED CLASSICS:3",
      "info": "Each category: id:Display Name:count"
    },
    {
      "type": "text",
      "id": "cta_text",
      "label": "Card CTA Text",
      "default": "BESTEL"
    },
    {
      "type": "text",
      "id": "footer_text",
      "label": "Footer Text",
      "default": "Prijzen per 12-pack • Gratis verzending vanaf €50"
    },
    {
      "type": "text",
      "id": "view_all_text",
      "label": "View All Text",
      "default": "BEKIJK ALLE PRODUCTEN"
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View All Link"
    },
    {
      "type": "header",
      "content": "Reviews CTA Button"
    },
    {
      "type": "text",
      "id": "reviews_cta_text",
      "label": "CTA Button Text",
      "default": "Ontdek alle smaken"
    },
    {
      "type": "url",
      "id": "reviews_cta_url",
      "label": "CTA Button URL"
    },
    {
      "type": "header",
      "content": "Section Layout"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 200,
      "step": 10,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding Bottom",
      "min": 0,
      "max": 200,
      "step": 10,
      "default": 100,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "Container Max Width",
      "min": 800,
      "max": 1600,
      "step": 50,
      "default": 1400,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "grid_columns_desktop",
      "label": "Grid Columns (Desktop)",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 5
    },
    {
      "type": "range",
      "id": "grid_columns_mobile",
      "label": "Grid Columns (Mobile)",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2
    },
    {
      "type": "range",
      "id": "grid_gap",
      "label": "Grid Gap",
      "min": 8,
      "max": 48,
      "step": 4,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#F8F7F5"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#1A1A1A"
    },
    {
      "type": "color",
      "id": "muted_color",
      "label": "Muted Text Color",
      "default": "#6B6B6B"
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "Primary/Accent Color",
      "default": "#C5A572"
    },
    {
      "type": "checkbox",
      "id": "enable_texture_overlay",
      "label": "Enable Texture Overlay",
      "default": true
    },
    {
      "type": "header",
      "content": "Glass Card Effect"
    },
    {
      "type": "range",
      "id": "card_bg_opacity",
      "label": "Card Background Opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 70,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "card_blur_amount",
      "label": "Card Backdrop Blur",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 12,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card Border Radius",
      "min": 0,
      "max": 48,
      "step": 4,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_border_opacity",
      "label": "Card Border Opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 10,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "card_shadow_intensity",
      "label": "Card Shadow Intensity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 30,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "footer_bg_opacity",
      "label": "Footer Background Opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 60,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "footer_blur_amount",
      "label": "Footer Backdrop Blur",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 8,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Accent Line"
    },
    {
      "type": "checkbox",
      "id": "show_accent_line",
      "label": "Show Accent Line",
      "default": true
    },
    {
      "type": "range",
      "id": "accent_line_height",
      "label": "Accent Line Height",
      "min": 1,
      "max": 8,
      "step": 1,
      "default": 3,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "accent_line_hover_height",
      "label": "Accent Line Hover Height",
      "min": 1,
      "max": 12,
      "step": 1,
      "default": 5,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "accent_line_glow",
      "label": "Accent Line Glow Intensity",
      "min": 0,
      "max": 50,
      "step": 5,
      "default": 15,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Glow Effects"
    },
    {
      "type": "range",
      "id": "glow_default_opacity",
      "label": "Default Glow Opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 60,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "glow_hover_opacity",
      "label": "Hover Glow Opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 100,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "glow_scale_on_hover",
      "label": "Glow Scale on Hover",
      "min": 100,
      "max": 150,
      "step": 5,
      "default": 110,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "gradient_default_opacity",
      "label": "Default Gradient Opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 50,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "gradient_hover_opacity",
      "label": "Hover Gradient Opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 85,
      "unit": "%"
    },
    {
      "type": "header",
      "content": "Hover Animations"
    },
    {
      "type": "range",
      "id": "card_lift_amount",
      "label": "Card Lift on Hover",
      "min": 0,
      "max": 30,
      "step": 1,
      "default": 15,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "image_scale_amount",
      "label": "Image Scale on Hover",
      "min": 100,
      "max": 130,
      "step": 2,
      "default": 112,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "image_rotate_amount",
      "label": "Image Rotation on Hover",
      "min": 0,
      "max": 15,
      "step": 1,
      "default": 5,
      "unit": "deg"
    },
    {
      "type": "range",
      "id": "animation_duration",
      "label": "Animation Duration",
      "min": 100,
      "max": 1000,
      "step": 50,
      "default": 400,
      "unit": "ms"
    },
    {
      "type": "select",
      "id": "animation_easing",
      "label": "Animation Easing",
      "options": [
        { "value": "ease", "label": "Ease" },
        { "value": "ease-in-out", "label": "Ease In-Out" },
        { "value": "ease-out", "label": "Ease Out" },
        { "value": "cubic-bezier(0.16, 1, 0.3, 1)", "label": "Smooth (Recommended)" },
        { "value": "linear", "label": "Linear" }
      ],
      "default": "cubic-bezier(0.16, 1, 0.3, 1)"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "title_font_size",
      "label": "Card Title Size",
      "min": 12,
      "max": 36,
      "step": 2,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "description_font_size",
      "label": "Description Size",
      "min": 10,
      "max": 18,
      "step": 1,
      "default": 14,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "price_font_size",
      "label": "Price Size",
      "min": 14,
      "max": 32,
      "step": 2,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "cta_font_size",
      "label": "CTA Button Text Size",
      "min": 10,
      "max": 18,
      "step": 1,
      "default": 14,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "cta_padding_x",
      "label": "CTA Horizontal Padding",
      "min": 8,
      "max": 32,
      "step": 2,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "cta_padding_y",
      "label": "CTA Vertical Padding",
      "min": 4,
      "max": 20,
      "step": 2,
      "default": 8,
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "usp",
      "name": "USP Tag",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "USP Text",
          "default": "63 kcal"
        }
      ]
    },
    {
      "type": "product",
      "name": "Product Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Product Image"
        },
        {
          "type": "text",
          "id": "name",
          "label": "Product Name",
          "default": "Raspberry"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Product Description",
          "default": "Fris en fruitig met een vleugje framboos"
        },
        {
          "type": "text",
          "id": "price",
          "label": "Price",
          "default": "€22,25"
        },
        {
          "type": "select",
          "id": "category",
          "label": "Category",
          "options": [
            { "value": "seltzer", "label": "Hard Seltzer" },
            { "value": "icedtea", "label": "Hard Iced Tea" },
            { "value": "classics", "label": "Mixed Classics" }
          ],
          "default": "seltzer"
        },
        {
          "type": "color",
          "id": "accent_color",
          "label": "Accent Color (for top line and glow)",
          "default": "#EC4899"
        },
        {
          "type": "url",
          "id": "product_link",
          "label": "Product Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Flavors",
      "blocks": [
        { "type": "usp", "settings": { "text": "63 kcal" } },
        { "type": "usp", "settings": { "text": "Geen suiker" } },
        { "type": "usp", "settings": { "text": "Glutenvrij" } },
        { "type": "usp", "settings": { "text": "4,5% alcohol" } },
        { "type": "product", "settings": { "name": "Raspberry", "description": "Fris en fruitig met een vleugje framboos", "price": "€22,25", "category": "seltzer", "accent_color": "#EC4899" } },
        { "type": "product", "settings": { "name": "Peach", "description": "Zoete perzik met een verfrissende kick", "price": "€22,25", "category": "seltzer", "accent_color": "#FB923C" } },
        { "type": "product", "settings": { "name": "Mango", "description": "Tropische mango voor zomerse vibes", "price": "€22,25", "category": "seltzer", "accent_color": "#FACC15" } },
        { "type": "product", "settings": { "name": "Lime", "description": "Frisse limoen voor de pure smaak", "price": "€22,25", "category": "seltzer", "accent_color": "#A3E635" } },
        { "type": "product", "settings": { "name": "Passionfruit", "description": "Exotische passievrucht vol smaak", "price": "€22,25", "category": "seltzer", "accent_color": "#A855F7" } },
        { "type": "product", "settings": { "name": "Lemon", "description": "Groene thee met frisse citroen", "price": "€22,25", "category": "icedtea", "accent_color": "#FDE047" } },
        { "type": "product", "settings": { "name": "Peach Tea", "description": "Zachte perziksmaak, koolzuurloos", "price": "€22,25", "category": "icedtea", "accent_color": "#FB923C" } },
        { "type": "product", "settings": { "name": "Mango Tea", "description": "Fruitige mango ice tea", "price": "€22,25", "category": "icedtea", "accent_color": "#F59E0B" } },
        { "type": "product", "settings": { "name": "Apple", "description": "Sappige appel, koolzuurloos", "price": "€22,25", "category": "icedtea", "accent_color": "#4ADE80" } },
        { "type": "product", "settings": { "name": "Spritz", "description": "Ready to drink Aperol-style cocktail", "price": "€22,25", "category": "classics", "accent_color": "#F97316" } },
        { "type": "product", "settings": { "name": "Gin & Tonic", "description": "Premium craft gin met botanische ingrediënten", "price": "€22,25", "category": "classics", "accent_color": "#22D3EE" } },
        { "type": "product", "settings": { "name": "Moscow Mule", "description": "Wodka met gember en limoen", "price": "€22,25", "category": "classics", "accent_color": "#D97706" } }
      ]
    }
  ]
}
{% endschema %}


